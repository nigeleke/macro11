      1                                 ;;;;
      2                                 ;
      3                                 ; test backslash-evaluating arguments to macros
      4                                 ;
      5                                         .list me
      6                                         .macro test x
      7                                         .blkb x               ; test some directive that wants an expression
      8                                         .endm
      9
     10         000010                          size = 10
     11         000002                          foo = 2
     12
     13                                     ; likes:
     14
     15 000000                                  test size             ; not replaced by "10"
      1 000000  000010                          .blkb size               ; test some directive that wants an expression
     16 000010                                  test \size            ; replaced by "10"
      1 000010  000010                          .blkb 10               ; test some directive that wants an expression
     17 000020                                  test \<size>          ; ditto
      1 000020  000010                          .blkb 10               ; test some directive that wants an expression
     18 000030                                  test \<size + foo>    ; replaced by "12"
      1 000030  000012                          .blkb 12               ; test some directive that wants an expression
     19 000042                                  test ^/size + foo/    ; arg is "size + foo", not "12"
      1 000042  000012                          .blkb size + foo               ; test some directive that wants an expression
     20
     21                                     ; dislikes:
     22
     23 000054                                  test <\size>          ; parameter is \size, which might be ok for
test-bsl-mac-arg.mac:23->TEST:1: ***ERROR Argument to .BLKB/.BLKW must be constant
      1                                         .blkb \size               ; test some directive that wants an expression
     24                                                               ; macros where the argument is used differently.
     25 000054                                  test size + foo       ; gets split at the space
      1 000054  000010                          .blkb size               ; test some directive that wants an expression
     26 000064                                  test /size + foo/     ; gets split at the space
test-bsl-mac-arg.mac:26->TEST:1: ***ERROR Argument to .BLKB/.BLKW must be constant
      1                                         .blkb /size               ; test some directive that wants an expression
test-bsl-mac-arg.mac:27: ***ERROR Constant value required
     27 000064                                  test \/size + foo/    ; invalid expression with division operator
      1 000064  000000                          .blkb 0               ; test some directive that wants an expression
     28 000064                                  test \^/size + foo/   ; original dislikes this, but we accept it.
      1 000064  000012                          .blkb 12               ; test some directive that wants an expression
     29
     30         000001                          .end


Symbol table

FOO   = 000002           SIZE  = 000010          


Program sections

. ABS.  000000    000   (RW,I,GBL,ABS,OVR)
        000076    001   (RW,I,LCL,REL,CON)
