      1                                 ;;;;;
      2                                 ;
      3                                 ; Test operand checking for various instructions and try to exercise
      4                                 ; all operand parsing error messages.
      5                                 ; Some cases are checked elsewhere (e.g. test-jmp.mac).
      6                                 ;
      7
      8                                 ; OC_MARK
      9
     10 000000  006400                          mark    0
     11 000002  006401                          mark    1
     12 000004  006477                          mark    77
test-operands.mac:13: ***ERROR MARK 64. is out of range [0:63.]
     13 000006  006400                          mark    100             ; too large
test-operands.mac:14: ***ERROR MARK requires a simple literal operand
     14 000010  006400                          mark    .               ; must be literal
test-operands.mac:15: ***ERROR Junk at end of line (',0             ; bad')
     15 000012  006400                          mark    0,0             ; bad
test-operands.mac:16: ***WARNING Use of immediate mode (MARK #n) is not strictly allowed
     16 000014  006400                          mark    #0              ; warning
     17
     18 000016  104000                          emt     0
     19 000020  104001                          emt     1
     20 000022  104377                          emt     255.
test-operands.mac:21: ***ERROR EMT ^O400 is out of range [-400:377]
     21 000024  104000                          emt     256.            ; too large
     22 000026     026'    210                  emt     .               ; allowed though strange
test-operands.mac:23: ***WARNING Use of immediate mode (EMT #n) is not strictly allowed
     23 000030  104000                          emt     #0              ; warning
     24
     25 000032  104400                          trap    0
     26 000034  104401                          trap    1
     27 000036  104777                          trap    255.
test-operands.mac:28: ***ERROR TRAP ^O400 is out of range [-400:377]
     28 000040  104400                          trap    256.            ; too large
     29 000042     042'    211                  trap    .               ; allowed though strange
test-operands.mac:30: ***WARNING Use of immediate mode (TRAP #n) is not strictly allowed
     30 000044  104400                          trap    #0              ; warning
     31
     32                                 ; OC_1GEN
     33
     34 000046  005700                          tst     r0
test-operands.mac:35: ***ERROR Junk at end of line (',(r0)         ; bad')
     35 000050  005700                          tst     r0,(r0)         ; bad
test-operands.mac:36: ***ERROR Invalid addressing mode (Invalid expression)
     36                                         tst     @               ; bad
**:0: ***ERROR Register expression out of range
test-operands.mac:37: ***ERROR Invalid addressing mode (Invalid register)
     37 000052  177700                          tst     %77             ; bad
test-operands.mac:38: ***ERROR Invalid addressing mode (Invalid expression)
     38                                         tst     <>              ; bad
     39
     40                                 ; OC_2GEN
     41
     42 000054  060001                          add     r0,r1
test-operands.mac:43: ***ERROR Junk at end of line (',r2        ; bad')
     43 000056  060001                          add     r0,r1,r2        ; bad
test-operands.mac:44: ***ERROR Invalid addressing mode (1st operand: Invalid expression)
     44                                         add     @               ; bad
test-operands.mac:45: ***ERROR Invalid syntax (comma expected)
     45                                         add     r0 r1           ; bad
test-operands.mac:46: ***ERROR Invalid addressing mode (2nd operand: Invalid expression)
     46                                         add     r0,@            ; bad
     47
     48                                 ; OC_BR
     49
     50                                         ; branch offset is counted in words
     51                                         ; from the address after instruction (. + 2)
     52
test-operands.mac:53: ***ERROR Branch target out of range (distance=-402)
     53 000060  000400                          br      .+2-258.        ; bad
     54 000062  000600                          br      .+2-256.
     55 000064  000400                          br      .+2
     56 000066  000577                          br      .+2+254.
test-operands.mac:57: ***ERROR Branch target out of range (distance=400)
     57 000070  000400                          br      .+2+256.        ; bad
test-operands.mac:58: ***ERROR Bad branch target (odd address)
     58 000072  000400                          br      .+2+1           ; bad (odd)
     59
     60                                 ; OC_SOB
     61
     62 000074  077001                          sob     r0,.
     63 000076  077001                          sob     0,.             ; yes MACRO11 accepts this
test-operands.mac:64: ***ERROR Junk at end of line (',3          ; bad')
     64 000100  077001                          sob     r0,.,3          ; bad
test-operands.mac:65: ***ERROR Invalid addressing mode (register expected)
     65                                         sob                     ; bad
test-operands.mac:66: ***ERROR Invalid syntax (comma expected)
     66                                         sob     r0              ; bad
test-operands.mac:67: ***ERROR Invalid syntax (comma expected)
     67                                         sob     r0 .            ; bad
test-operands.mac:68: ***ERROR Invalid addressing mode (register expected)
     68                                         sob     10,.            ; bad
     69
     70                                 ; OC_ASH
     71
     72 000102  072027  000003                  ash     #3,r0
     73 000106  072027  000003                  ash     #3,0            ; yes MACRO11 accepts this
test-operands.mac:74: ***ERROR Junk at end of line (',r1        ; bad')
     74 000112  072027  000003                  ash     #3,r0,r1        ; bad
test-operands.mac:75: ***ERROR Invalid addressing mode (1st operand: Invalid expression)
     75                                         ash                     ; bad
test-operands.mac:76: ***ERROR Invalid syntax (comma expected)
     76                                         ash     #3              ; bad
test-operands.mac:77: ***ERROR Invalid syntax (comma expected)
     77                                         ash     #3 r0           ; bad
test-operands.mac:78: ***ERROR Invalid addressing mode (2nd operand: register expected)
     78                                         ash     #3,#0           ; bad
     79
     80                                 ; OC_JSR        tested in test-jmp.mac
     81
     82                                 ; OC_FPPGENAC
     83
     84         000001                  ac1 = %1
     85         000005                  ac5 = %5
     86
     87 000116  171111                          mulf    (r1),ac1
     88 000120  171111                          mulf    (r1),1
test-operands.mac:89: ***ERROR Junk at end of line (',ac1    ; bad')
     89 000122  171111                          mulf    (r1),ac1,ac1    ; bad
test-operands.mac:90: ***ERROR Invalid addressing mode (1st operand, fsrc: Invalid expression)
     90                                         mulf                    ; bad
test-operands.mac:91: ***ERROR Invalid addressing mode (1st operand, fsrc: ')' expected after register)
     91                                         mulf    (               ; bad
test-operands.mac:92: ***ERROR Invalid syntax (comma expected)
     92                                         mulf    (r1)            ; bad
test-operands.mac:93: ***ERROR Invalid syntax (comma expected)
     93                                         mulf    (r1) ac1        ; bad
test-operands.mac:94: ***ERROR Invalid destination fp register
     94 000124  171011                          mulf    (r1),ac5        ; bad
     95
     96                                 ; OC_FPPACGEN
     97
     98 000126  174115                          stf     ac1,(r5)
     99 000130  174115                          stf     1,(r5)
test-operands.mac:100: ***ERROR Invalid source fp register
test-operands.mac:100: ***ERROR Invalid syntax (comma expected)
    100                                         stf                     ; bad
test-operands.mac:101: ***ERROR Invalid syntax (comma expected)
    101                                         stf     ac1             ; bad
test-operands.mac:102: ***ERROR Invalid syntax (comma expected)
    102                                         stf     ac1 (r5)        ; bad
test-operands.mac:103: ***ERROR Invalid source fp register
    103 000132  174015                          stf     ac5,(r5)        ; bad
    104
    105                                 ; OC_CIS2       operands are optional and an extension
    106
    107 000134  076152                          cmpni
    108 000136  076152  000001  000002          cmpni   1,2
test-operands.mac:109: ***ERROR Junk at end of line (',3           ; bad')
    109 000144  076152  000001  000002          cmpni   1,2,3           ; bad
test-operands.mac:110: ***ERROR Invalid syntax (operand 2: comma expected)
test-operands.mac:110: ***ERROR Invalid expression (operand 2)
test-operands.mac:110: ***ERROR Invalid expression (complex relocation)
    110 000152  076152  000003  000000          cmpni   3               ; bad
test-operands.mac:111: ***ERROR Invalid syntax (operand 2: comma expected)
    111 000160  076152  000004  000005          cmpni   4 5             ; bad
test-operands.mac:112: ***ERROR Invalid expression (operand 1)
test-operands.mac:112: ***ERROR Invalid expression (operand 2)
test-operands.mac:112: ***ERROR Invalid expression (complex relocation)
test-operands.mac:112: ***ERROR Invalid expression (complex relocation)
    112 000166  076152  000000  000000          cmpni   <>,<>           ; bad
    113
    114                                 ; OC_CIS3       operands are optional and an extension
    115
    116 000174  076150                          addni
    117 000176  076150  000001  000002          addni   1,2,3
        000204  000003
    118 000206  076150  000001  000002          addni   1,2,3,4         ; bad
test-operands.mac:118: ***ERROR Junk at end of line (',4         ; bad')
        000214  000003
test-operands.mac:119: ***ERROR Invalid syntax (operand 2: comma expected)
test-operands.mac:119: ***ERROR Invalid expression (operand 2)
test-operands.mac:119: ***ERROR Invalid syntax (operand 3: comma expected)
test-operands.mac:119: ***ERROR Invalid expression (operand 3)
test-operands.mac:119: ***ERROR Invalid expression (complex relocation)
test-operands.mac:119: ***ERROR Invalid expression (complex relocation)
    119 000216  076150  000001  000000          addni   1               ; bad
        000224  000000
test-operands.mac:120: ***ERROR Invalid syntax (operand 3: comma expected)
test-operands.mac:120: ***ERROR Invalid expression (operand 3)
test-operands.mac:120: ***ERROR Invalid expression (complex relocation)
    120 000226  076150  000001  000002          addni   1,2             ; bad
        000234  000000
test-operands.mac:121: ***ERROR Invalid syntax (operand 2: comma expected)
test-operands.mac:121: ***ERROR Invalid syntax (operand 3: comma expected)
    121 000236  076150  000001  000002          addni   1 2 3           ; bad
        000244  000003
test-operands.mac:122: ***ERROR Invalid expression (operand 1)
test-operands.mac:122: ***ERROR Invalid expression (operand 2)
test-operands.mac:122: ***ERROR Invalid expression (operand 3)
test-operands.mac:122: ***ERROR Invalid expression (complex relocation)
test-operands.mac:122: ***ERROR Invalid expression (complex relocation)
test-operands.mac:122: ***ERROR Invalid expression (complex relocation)
    122 000246  076150  000000  000000          addni   <>,<>,<>        ; bad
        000254  000000
    123
    124                                 ; OC_CIS4       operands are optional and an extension
    125
    126 000256  076132                          movtci
    127 000260  076132  000001  000002          movtci  1,2,3,4
        000266  000003  000004
    128 000272  076132  000001  000002          movtci  1,2,3,4,5
test-operands.mac:128: ***ERROR Junk at end of line (',5')
        000300  000003  000004
test-operands.mac:129: ***ERROR Invalid syntax (operand 2: comma expected)
test-operands.mac:129: ***ERROR Invalid expression (operand 2)
test-operands.mac:129: ***ERROR Invalid syntax (operand 3: comma expected)
test-operands.mac:129: ***ERROR Invalid expression (operand 3)
test-operands.mac:129: ***ERROR Invalid syntax (operand 4: comma expected)
test-operands.mac:129: ***ERROR Invalid expression (operand 4)
test-operands.mac:129: ***ERROR Invalid expression (complex relocation)
test-operands.mac:129: ***ERROR Invalid expression (complex relocation)
    129 000304  076132  000001  000000          movtci  1               ; bad
test-operands.mac:129: ***ERROR Invalid expression (complex relocation)
        000312  000000  000000
test-operands.mac:130: ***ERROR Invalid syntax (operand 3: comma expected)
test-operands.mac:130: ***ERROR Invalid expression (operand 3)
test-operands.mac:130: ***ERROR Invalid syntax (operand 4: comma expected)
test-operands.mac:130: ***ERROR Invalid expression (operand 4)
test-operands.mac:130: ***ERROR Invalid expression (complex relocation)
    130 000316  076132  000001  000002          movtci  1,2             ; bad
test-operands.mac:130: ***ERROR Invalid expression (complex relocation)
        000324  000000  000000
test-operands.mac:131: ***ERROR Invalid syntax (operand 4: comma expected)
test-operands.mac:131: ***ERROR Invalid expression (operand 4)
    131 000330  076132  000001  000002          movtci  1,2,3           ; bad
test-operands.mac:131: ***ERROR Invalid expression (complex relocation)
        000336  000003  000000
test-operands.mac:132: ***ERROR Invalid syntax (operand 2: comma expected)
test-operands.mac:132: ***ERROR Invalid syntax (operand 3: comma expected)
test-operands.mac:132: ***ERROR Invalid syntax (operand 4: comma expected)
    132 000342  076132  000001  000002          movtci  1 2 3 4         ; bad
        000350  000003  000004
test-operands.mac:133: ***ERROR Invalid expression (operand 1)
test-operands.mac:133: ***ERROR Invalid expression (operand 2)
test-operands.mac:133: ***ERROR Invalid expression (operand 3)
test-operands.mac:133: ***ERROR Invalid expression (operand 4)
test-operands.mac:133: ***ERROR Invalid expression (complex relocation)
test-operands.mac:133: ***ERROR Invalid expression (complex relocation)
test-operands.mac:133: ***ERROR Invalid expression (complex relocation)
    133 000354  076132  000000  000000          movtci  <>,<>,<>,<>     ; bad
test-operands.mac:133: ***ERROR Invalid expression (complex relocation)
        000362  000000  000000
    134
    135         000001                          .end


Symbol table

AC1   =%000001           AC5   =%000005          


Program sections

. ABS.  000000    000   (RW,I,GBL,ABS,OVR)
        000366    001   (RW,I,LCL,REL,CON)
